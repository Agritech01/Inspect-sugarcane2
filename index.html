<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBS Sugar - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à 69/70</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --kbs-green: #2E7D32; --kbs-orange: #FF9800; --bg-light: #F4F7F6; }
        body { font-family: 'Sarabun', sans-serif; background-color: var(--bg-light); }
        .kbs-header { 
            background: linear-gradient(135deg, var(--kbs-green) 0%, #1565C0 100%); 
            color: white; padding: 2rem 0; border-bottom: 5px solid var(--kbs-orange); 
        }
        .nav-tabs-kbs { border: none; gap: 10px; margin-bottom: 20px; }
        .nav-tabs-kbs .nav-link { 
            border: none; background: #e9ecef; color: #666; border-radius: 10px; 
            padding: 12px 25px; font-weight: 600; transition: 0.3s;
        }
        .nav-tabs-kbs .nav-link.active { 
            background: var(--kbs-green); color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
        }
        .table-container { 
            background: white; border-radius: 15px; padding: 25px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
        }
        .status-badge { padding: 6px 12px; border-radius: 50px; font-size: 0.8rem; font-weight: bold; }
        .loading-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(255,255,255,0.9); z-index: 9999; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
        }
    </style>
</head>
<body>

<div id="loader" class="loading-overlay">
    <div class="spinner-border text-success mb-3"></div>
    <div class="fw-bold text-success">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à...</div>
</div>

<div class="kbs-header">
    <div class="container d-md-flex align-items-center">
        <img src="https://i.postimg.cc/wMdZPmTL/skr-nch-xt-2026-01-12-092906.png" alt="KBS Logo" style="height: 50px; background: white; padding: 5px; border-radius: 5px;" class="me-3 mb-3 mb-md-0">
        <div>
            <h1 class="h4 fw-bold mb-0">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏õ‡∏•‡∏á ‡∏õ‡∏µ 69/70</h1>
            <p class="mb-0 opacity-75 small">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏µ‡∏ó: Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</p>
        </div>
    </div>
</div>

<div class="container mt-4">
    <ul class="nav nav-tabs nav-tabs-kbs">
        <li class="nav-item">
            <button class="nav-link active" onclick="switchProject('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70', this)">
                üåæ ‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ 69/70
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" onclick="switchProject('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢ ‡∏õ‡∏µ 69/70', this)">
                üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô 69/70
            </button>
        </li>
    </ul>

    <div class="table-container">
        <div class="row mb-3 align-items-center">
            <div class="col-md-5">
                <div class="input-group">
                    <span class="input-group-text bg-white border-end-0"><i class="fas fa-search text-muted"></i></span>
                    <input type="text" id="searchInput" onkeyup="doSearch()" class="form-control border-start-0" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà/‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á/‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤...">
                </div>
            </div>
            <div class="col-md-7 text-md-end text-muted small">
                <span id="dataCount">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th>‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏áintech</th>
                        <th>‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ / ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà</th>
                        <th>‡πÄ‡∏Ç‡∏ï</th>
                        <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£ / ‡∏ä‡∏∑‡πà‡∏≠</th>
                        <th class="text-end">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)</th>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</th>
                        <th class="text-center">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                        <th class="text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // ‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏∏ Sheet ID ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Publish to Web ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏µ‡∏ó "Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à" ‡πÄ‡∏õ‡πá‡∏ô CSV
    const SHEET_ID = '2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn';
    
    // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ gid ‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ó "Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à" (‡∏î‡∏π‡πÄ‡∏•‡∏Ç gid ‡∏à‡∏≤‡∏Å URL ‡πÉ‡∏ô Google Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    const gid = '‡πÉ‡∏™‡πà_GID_‡∏Ç‡∏≠‡∏á_Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à_‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà'; 
    const csvUrl = `https://docs.google.com/spreadsheets/d/e/${SHEET_ID}/pub?gid=${gid}&output=csv`;

    let auditData = [];
    let currentFilter = '‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70';

    async function loadData() {
        try {
            const response = await fetch(csvUrl);
            const text = await response.text();
            auditData = parseCSV(text);
            
            document.getElementById('loader').style.display = 'none';
            renderTable();
        } catch (error) {
            console.error(error);
            document.getElementById('tableBody').innerHTML = `<tr><td colspan="8" class="text-center p-5 text-danger">‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Publish CSV ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏Ç GID</td></tr>`;
        }
    }

    function parseCSV(text) {
        const rows = text.split('\n');
        // ‡∏î‡∏∂‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î
        const headers = rows[0].split(',').map(h => h.trim().replace(/"/g, ''));
        
        return rows.slice(1).map(row => {
            const values = row.split(',').map(v => v.trim().replace(/"/g, ''));
            const obj = {};
            headers.forEach((header, i) => obj[header] = values[i]);
            return obj;
        });
    }

    function switchProject(projectName, btn) {
        currentFilter = projectName;
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        btn.classList.add('active');
        renderTable();
    }

    function renderTable() {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';

        // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£"
        const filtered = auditData.filter(row => row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] === currentFilter);

        document.getElementById('dataCount').innerText = `‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${filtered.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;

        if (filtered.length === 0) {
            tbody.innerHTML = `<tr><td colspan="8" class="text-center p-5 text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "${currentFilter}" ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</td></tr>`;
            return;
        }

        filtered.forEach(row => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="fw-bold text-primary">${row['‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏áintech'] || '-'}</td>
                <td>
                    <div class="fw-bold">${row['‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà'] || '-'}</div>
                    <div class="small text-muted">‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤: ${row['‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤'] || '-'}</div>
                </td>
                <td class="text-center"><span class="badge bg-secondary">‡πÄ‡∏Ç‡∏ï ${row['‡πÄ‡∏Ç‡∏ï'] || '-'}</span></td>
                <td>
                    <div class="small fw-bold">${row['‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£'] || '-'}</div>
                    <div class="text-muted" style="font-size: 0.7rem;">‡∏£‡∏´‡∏±‡∏™: ${row['‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£'] || '-'}</div>
                </td>
                <td class="text-end fw-bold">${parseFloat(row['‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà'] || 0).toFixed(2)}</td>
                <td class="small">${row['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å'] || '-'}</td>
                <td class="text-center">
                    <span class="status-badge bg-light text-dark border">
                        ${row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] || '-'}
                    </span>
                </td>
                <td class="text-center">
                    <button class="btn btn-sm btn-outline-success"><i class="fas fa-search"></i></button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function doSearch() {
        const q = document.getElementById('searchInput').value.toLowerCase();
        const rows = document.querySelectorAll('#tableBody tr');
        rows.forEach(r => r.style.display = r.innerText.toLowerCase().includes(q) ? '' : 'none');
    }

    loadData();
</script>

</body>
</html>
