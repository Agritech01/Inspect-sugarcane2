<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Data ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à 69/70</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        .active-tab { background-color: #ffffff; border-top: 4px solid #10b981; color: #065f46; font-weight: 600; }
        .table-card { background: white; border-radius: 0 1rem 1rem 1rem; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        tr:hover { background-color: #f0fdfa; transition: 0.2s; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="mb-6">
            <h1 class="text-3xl font-bold text-slate-800">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏ä‡∏µ‡∏ó Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</h1>
            <p class="text-slate-500 text-sm mt-1">‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏õ‡∏µ 69/70</p>
        </header>

        <div class="flex flex-wrap gap-1">
            <button onclick="filterProject('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70', this)" 
                id="btn-default" class="px-6 py-4 rounded-t-xl bg-slate-200 text-slate-600 transition-all">
                üåæ ‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ 69/70
            </button>
            <button onclick="filterProject('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢ ‡∏õ‡∏µ 69/70', this)" 
                class="px-6 py-4 rounded-t-xl bg-slate-200 text-slate-600 transition-all">
                üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô 69/70
            </button>
        </div>

        <div class="table-card p-6 border border-slate-100">
            <div class="flex flex-col md:flex-row justify-between mb-6 gap-4">
                <input type="text" id="searchInput" onkeyup="searchTable()" 
                    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà / ‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ / ‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á..." 
                    class="w-full md:w-96 p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-emerald-500 outline-none">
                <div id="dataCount" class="bg-emerald-50 text-emerald-700 px-4 py-2 rounded-lg font-bold flex items-center shadow-sm">
                    ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
                </div>
            </div>

            <div class="overflow-x-auto rounded-xl border border-slate-100">
                <table class="w-full text-left" id="dataTable">
                    <thead class="bg-slate-50 text-slate-600 text-sm font-semibold uppercase">
                        <tr>
                            <th class="p-4 border-b">‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á Intech</th>
                            <th class="p-4 border-b">‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤</th>
                            <th class="p-4 border-b">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà</th>
                            <th class="p-4 border-b">‡πÄ‡∏Ç‡∏ï</th>
                            <th class="p-4 border-b">‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£ (‡∏£‡∏´‡∏±‡∏™/‡∏ä‡∏∑‡πà‡∏≠)</th>
                            <th class="p-4 border-b text-center">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)</th>
                            <th class="p-4 border-b">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</th>
                            <th class="p-4 border-b">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                            <th class="p-4 border-b text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-slate-100 text-slate-700 text-sm">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const sheetId = '2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn';
        // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡πâ‡∏≠‡∏á Publish ‡∏ä‡∏µ‡∏ó "Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à" ‡πÄ‡∏õ‡πá‡∏ô CSV ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        const url = `https://docs.google.com/spreadsheets/d/e/${sheetId}/pub?output=csv`;

        let rawData = [];

        async function init() {
            try {
                const response = await fetch(url);
                const text = await response.text();
                // ‡πÅ‡∏õ‡∏•‡∏á CSV ‡πÄ‡∏õ‡πá‡∏ô Array ‡πÇ‡∏î‡∏¢‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô
                rawData = text.split('\n').map(row => row.split(',').map(cell => cell.trim()));
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                filterProject('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70', document.getElementById('btn-default'));
            } catch (err) {
                document.getElementById('tableBody').innerHTML = '<tr><td colspan="9" class="p-10 text-center text-red-500 font-bold">‚ùå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Publish to Web ‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ó Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</td></tr>';
            }
        }

        function filterProject(projectName, btn) {
            // ‡∏™‡∏•‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
            document.querySelectorAll('button').forEach(b => b.className = b.className.replace('active-tab', 'bg-slate-200 text-slate-600'));
            btn.className = btn.className.replace('bg-slate-200 text-slate-600', 'active-tab');

            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 9 (Index 8)
            const filtered = rawData.slice(1).filter(row => {
                const status = row[8] || ''; // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 9
                return status.includes(projectName);
            });

            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" class="p-20 text-center text-slate-400">--- ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ ---</td></tr>';
                document.getElementById('dataCount').innerText = `‡∏û‡∏ö 0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
                return;
            }

            filtered.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="p-4 font-medium text-slate-900">${row[0] || '-'}</td>
                    <td class="p-4">${row[1] || '-'}</td>
                    <td class="p-4 font-semibold text-emerald-700">${row[2] || '-'}</td>
                    <td class="p-4 text-center">${row[3] || '-'}</td>
                    <td class="p-4">
                        <div class="text-[11px] text-slate-400">ID: ${row[4] || '-'}</div>
                        <div class="font-medium text-slate-600">${row[5] || '-'}</div>
                    </td>
                    <td class="p-4 text-center font-bold text-slate-800">${row[6] || '0'}</td>
                    <td class="p-4 text-slate-500">${row[7] || '-'}</td>
                    <td class="p-4">
                        <span class="px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-[10px] font-bold">
                            ${row[8] || '-'}
                        </span>
                    </td>
                    <td class="p-4 text-center">
                        <button class="px-4 py-1 rounded-lg border border-emerald-500 text-emerald-600 text-xs font-bold hover:bg-emerald-500 hover:text-white transition">‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            document.getElementById('dataCount').innerText = `üìä ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${filtered.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
        }

        function searchTable() {
            const input = document.getElementById("searchInput").value.toLowerCase();
            const rows = document.querySelectorAll("#tableBody tr");
            rows.forEach(r => {
                r.style.display = r.innerText.toLowerCase().includes(input) ? "" : "none";
            });
        }

        init();
    </script>
</body>
</html>
