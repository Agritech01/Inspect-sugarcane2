<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 69/70</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f3f4f6; }
        .tab-active { background-color: white; border-top: 4px solid #059669; color: #059669; font-weight: 600; }
        .glass-table { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px); }
    </style>
</head>
<body class="min-h-screen p-4 md:p-10">

    <div class="max-w-7xl mx-auto">
        <header class="mb-8 text-center md:text-left">
            <h1 class="text-3xl font-bold text-gray-800">üìä ‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Data ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h1>
            <p class="text-gray-500 mt-2">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå‡∏à‡∏≤‡∏Å Google Sheets (‡∏õ‡∏µ 69/70)</p>
        </header>

        <div class="flex flex-col md:flex-row gap-1">
            <button onclick="filterByProject('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70', this)" 
                class="tab-btn px-6 py-4 rounded-t-xl bg-gray-200 text-gray-600 transition-all hover:bg-gray-300">
                üöú ‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70
            </button>
            <button onclick="filterByProject('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢ ‡∏õ‡∏µ 69/70', this)" 
                class="tab-btn px-6 py-4 rounded-t-xl bg-gray-200 text-gray-600 transition-all hover:bg-gray-300">
                üå± ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢ ‡∏õ‡∏µ 69/70
            </button>
        </div>

        <div class="bg-white p-6 rounded-b-2xl shadow-xl border border-gray-100">
            
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                <div class="relative w-full md:w-96">
                    <input type="text" id="searchInput" onkeyup="searchFunction()" 
                        placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤..." 
                        class="w-full p-3 pl-10 rounded-xl border border-gray-200 shadow-sm focus:ring-2 focus:ring-green-500 outline-none">
                </div>
                <div id="countDisplay" class="bg-green-50 text-green-700 px-5 py-2 rounded-full font-semibold border border-green-100 shadow-sm">
                    ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
                </div>
            </div>

            <div class="overflow-x-auto rounded-xl">
                <table class="w-full text-left border-collapse" id="mainTable">
                    <thead class="bg-gray-50 text-gray-700 text-sm uppercase">
                        <tr>
                            <th class="p-4 border-b">‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á Intech</th>
                            <th class="p-4 border-b">‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤</th>
                            <th class="p-4 border-b">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà</th>
                            <th class="p-4 border-b">‡πÄ‡∏Ç‡∏ï</th>
                            <th class="p-4 border-b">‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£</th>
                            <th class="p-4 border-b text-center">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)</th>
                            <th class="p-4 border-b">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</th>
                            <th class="p-4 border-b">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                            <th class="p-4 border-b">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-gray-100 text-gray-600 text-sm">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const sheetId = '2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn';
        // ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ó "Data‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£" (‡∏ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Publish to Web ‡πÑ‡∏ß‡πâ)
        const url = `https://docs.google.com/spreadsheets/d/e/${sheetId}/pub?output=csv`;

        let rawData = [];
        let currentFilter = '‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70';

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        async function fetchSheetData() {
            try {
                const response = await fetch(url);
                const data = await response.text();
                // ‡πÅ‡∏õ‡∏•‡∏á CSV ‡πÄ‡∏õ‡πá‡∏ô Array
                rawData = data.split('\n').map(row => row.split(',').map(cell => cell.trim()));
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏£‡∏Å‡πÉ‡∏´‡πâ Active
                const firstBtn = document.querySelectorAll('.tab-btn')[0];
                filterByProject('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70', firstBtn);
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('tableBody').innerHTML = '<tr><td colspan="9" class="p-10 text-center text-red-500">‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Publish to Web</td></tr>';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function filterByProject(projectName, btnElement) {
            currentFilter = projectName;
            
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('tab-active'));
            btnElement.classList.add('tab-active');

            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 9 ‡∏Ñ‡∏∑‡∏≠ index 8)
            const filtered = rawData.slice(1).filter(row => {
                const statusProject = row[8] || '';
                return statusProject.includes(projectName);
            });

            if (filtered.length === 0) {
                tbody.innerHTML = `<tr><td colspan="9" class="p-20 text-center text-gray-400">--- ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ${projectName} ---</td></tr>`;
            } else {
                filtered.forEach(col => {
                    const tr = document.createElement('tr');
                    tr.className = 'hover:bg-green-50 transition-colors';
                    tr.innerHTML = `
                        <td class="p-4 font-medium text-gray-900">${col[0] || '-'}</td>
                        <td class="p-4">${col[1] || '-'}</td>
                        <td class="p-4 font-bold text-green-800">${col[2] || '-'}</td>
                        <td class="p-4 text-center">${col[3] || '-'}</td>
                        <td class="p-4">
                            <div class="text-xs text-gray-400">‡∏£‡∏´‡∏±‡∏™: ${col[4] || '-'}</div>
                            <div class="font-medium">${col[5] || '-'}</div>
                        </td>
                        <td class="p-4 text-center font-bold text-gray-700">${col[6] || '0'}</td>
                        <td class="p-4 text-gray-500">${col[7] || '-'}</td>
                        <td class="p-4">
                            <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-[10px] font-bold">
                                ${col[8] || '-'}
                            </span>
                        </td>
                        <td class="p-4 text-center">
                            <button class="text-green-600 hover:text-green-800 font-semibold underline">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            document.getElementById('countDisplay').innerText = `üìä ‡∏û‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${filtered.length} ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠`;
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        function searchFunction() {
            const input = document.getElementById("searchInput").value.toLowerCase();
            const rows = document.querySelectorAll("#tableBody tr");
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(input) ? "" : "none";
            });
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        fetchSheetData();
    </script>
</body>
</html>
