<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        .tab-active { border-bottom: 4px solid #0d9488; color: #0d9488; font-weight: 600; }
        .table-card { background: white; border-radius: 1.5rem; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05); }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4">
            <div>
                <h1 class="text-3xl font-bold text-slate-800">‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Data ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h1>
                <p class="text-slate-500">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</p>
            </div>
            <div class="text-right text-xs text-slate-400">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
        </div>

        <div class="flex gap-8 mb-6 border-b border-slate-200 text-slate-500 overflow-x-auto">
            <button onclick="switchTab('‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 1')" id="tab1" class="tab-active py-3 px-4 transition-all whitespace-nowrap">
                üìã ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà 1
            </button>
            <button onclick="switchTab('‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 2')" id="tab2" class="py-3 px-4 transition-all whitespace-nowrap">
                üìã ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà 2
            </button>
        </div>

        <div class="mb-6 flex flex-col md:flex-row gap-4 justify-between">
            <input type="text" id="searchInput" onkeyup="searchTable()" 
                placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà/‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ..." 
                class="p-3 px-5 rounded-xl border border-slate-200 w-full md:w-80 focus:ring-2 focus:ring-teal-500 outline-none shadow-sm">
            <div id="rowCount" class="bg-teal-50 text-teal-700 px-4 py-2 rounded-lg text-sm font-medium self-start">
                ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...
            </div>
        </div>

        <div class="table-card overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-left" id="dataTable">
                    <thead class="bg-slate-50 text-slate-600 text-sm uppercase tracking-wider">
                        <tr>
                            <th class="p-4 font-semibold">‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á Intech</th>
                            <th class="p-4 font-semibold">‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤</th>
                            <th class="p-4 font-semibold">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà</th>
                            <th class="p-4 font-semibold text-center">‡πÄ‡∏Ç‡∏ï</th>
                            <th class="p-4 font-semibold">‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£</th>
                            <th class="p-4 font-semibold text-center">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th class="p-4 font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</th>
                            <th class="p-4 font-semibold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</th>
                            <th class="p-4 font-semibold text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-slate-100 text-slate-700 text-sm">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const sheetId = '2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn';
        const url = `https://docs.google.com/spreadsheets/d/e/${sheetId}/pub?output=csv`;
        
        let allData = [];
        let currentProject = '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 1'; // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

        async function fetchData() {
            try {
                const response = await fetch(url);
                const csvText = await response.text();
                // ‡πÅ‡∏õ‡∏•‡∏á CSV ‡πÄ‡∏õ‡πá‡∏ô Array ‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
                allData = csvText.split('\n').map(row => row.split(',').map(cell => cell.trim()));
                renderTable();
            } catch (error) {
                document.getElementById('tableBody').innerHTML = '<tr><td colspan="9" class="text-center py-20 text-red-400">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
            }
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤ "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£" ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 8 (index 8)
            // ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏•‡∏Ç index ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
            const filteredData = allData.slice(1).filter(row => {
                const projectStatus = row[8] || ''; 
                return projectStatus.includes(currentProject);
            });

            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" class="text-center py-20 text-slate-400">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</td></tr>';
                document.getElementById('rowCount').innerText = `‡∏û‡∏ö 0 ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠`;
                return;
            }

            filteredData.forEach(col => {
                const tr = document.createElement('tr');
                tr.className = 'hover:bg-teal-50/50 transition-colors';
                tr.innerHTML = `
                    <td class="p-4 font-medium text-slate-900">${col[0] || '-'}</td>
                    <td class="p-4">${col[1] || '-'}</td>
                    <td class="p-4 font-semibold text-teal-700">${col[2] || '-'}</td>
                    <td class="p-4 text-center">${col[3] || '-'}</td>
                    <td class="p-4">
                        <div class="text-xs text-slate-400">${col[4] || '-'}</div>
                        <div class="font-medium">${col[5] || '-'}</div>
                    </td>
                    <td class="p-4 text-center font-bold text-slate-600">${col[6] || '0'} <span class="text-[10px] font-normal">‡πÑ‡∏£‡πà</span></td>
                    <td class="p-4 text-slate-500">${col[7] || '-'}</td>
                    <td class="p-4">
                        <span class="px-3 py-1 bg-teal-100 text-teal-700 rounded-full text-[11px] font-bold">
                            ${col[8] || '-'}
                        </span>
                    </td>
                    <td class="p-4 text-center">
                        <button class="text-teal-600 hover:text-teal-800 font-bold underline text-xs">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            document.getElementById('rowCount').innerText = `‡∏û‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${filteredData.length} ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ ‡πÉ‡∏ô${currentProject}`;
        }

        function switchTab(projectName) {
            currentProject = projectName;
            // ‡∏™‡∏•‡∏±‡∏ö Class UI
            document.getElementById('tab1').className = projectName === '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 1' ? 'tab-active py-3 px-4 transition-all whitespace-nowrap' : 'py-3 px-4 transition-all whitespace-nowrap';
            document.getElementById('tab2').className = projectName === '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 2' ? 'tab-active py-3 px-4 transition-all whitespace-nowrap' : 'py-3 px-4 transition-all whitespace-nowrap';
            
            renderTable();
        }

        function searchTable() {
            const input = document.getElementById("searchInput").value.toUpperCase();
            const tr = document.getElementById("tableBody").getElementsByTagName("tr");

            for (let i = 0; i < tr.length; i++) {
                const text = tr[i].innerText.toUpperCase();
                tr[i].style.display = text.indexOf(input) > -1 ? "" : "none";
            }
        }

        fetchData();
    </script>
</body>
</html>
