<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 69/70</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1300px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { color: #1b5e20; text-align: center; margin-bottom: 30px; }
        .nav-tabs { display: flex; justify-content: center; margin-bottom: 25px; gap: 10px; border-bottom: 2px solid #e0e0e0; }
        .tab { padding: 12px 25px; cursor: pointer; border: none; background: none; font-size: 16px; font-weight: bold; color: #757575; transition: 0.3s; }
        .tab.active { color: #2e7d32; border-bottom: 4px solid #2e7d32; }
        .tab:hover { background-color: #f1f8e9; }
        
        .table-responsive { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        th { background-color: #2e7d32; color: white; padding: 15px; text-align: center; font-weight: 400; font-size: 14px; white-space: nowrap; }
        td { border-bottom: 1px solid #eee; padding: 12px; text-align: center; font-size: 14px; }
        tr:hover { background-color: #f5f5f5; }
        
        .loading { text-align: center; padding: 50px; font-size: 18px; color: #2e7d32; }
        .empty-msg { text-align: center; padding: 40px; color: #999; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏õ‡∏µ 69/70</h1>
    
    <div class="nav-tabs">
        <button class="tab active" onclick="switchPage('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤')">‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70</button>
        <button class="tab" onclick="switchPage('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢')">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢ ‡∏õ‡∏µ 69/70</button>
    </div>

    <div class="table-responsive">
        <div id="loading" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets...</div>
        <table id="dataTable" style="display:none;">
            <thead>
                <tr id="tableHeader">
                    </tr>
            </thead>
            <tbody id="tableBody">
                </tbody>
        </table>
        <div id="emptyMsg" class="empty-msg" style="display:none;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ</div>
    </div>
</div>

<script>
    const sheetID = "2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn";
    const gidCheck = "1732816752"; // Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à
    const csvUrl = `https://docs.google.com/spreadsheets/d/e/${sheetID}/pub?gid=${gidCheck}&output=csv`;

    // ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏∞‡∏Å‡∏î‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô Google Sheet)
    const columnsToDisplay = [
        "‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏áintech", 
        "‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤", 
        "‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà", 
        "‡πÄ‡∏Ç‡∏ï", 
        "‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", 
        "‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", 
        "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà", 
        "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å", 
        "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£", 
        "‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£"
    ];

    let allData = [];

    async function fetchData() {
        try {
            const response = await fetch(csvUrl);
            const data = await response.text();
            allData = parseCSV(data);
            switchPage('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤');
        } catch (error) {
            document.getElementById('loading').innerHTML = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Publish Google Sheet";
            console.error(error);
        }
    }

    function parseCSV(csvText) {
        const lines = csvText.split("\n");
        if (lines.length === 0) return [];
        
        // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
        const headers = lines[0].split(",").map(h => h.trim().replace(/^"|"$/g, ''));
        
        return lines.slice(1).map(line => {
            const values = line.split(",").map(v => v.trim().replace(/^"|"$/g, ''));
            return headers.reduce((obj, header, i) => {
                obj[header] = values[i];
                return obj;
            }, {});
        });
    }

    function switchPage(statusFilter) {
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Tab
        document.querySelectorAll('.tab').forEach(btn => {
            btn.classList.toggle('active', btn.innerText.includes(statusFilter));
        });

        const tableBody = document.getElementById('tableBody');
        const tableHeader = document.getElementById('tableHeader');
        const table = document.getElementById('dataTable');
        const loading = document.getElementById('loading');
        const emptyMsg = document.getElementById('emptyMsg');
        
        tableBody.innerHTML = "";
        tableHeader.innerHTML = "";

        // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
        const filteredData = allData.filter(row => row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] === statusFilter);

        if (filteredData.length > 0) {
            // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
            columnsToDisplay.forEach(colName => {
                const th = document.createElement('th');
                th.innerText = colName;
                tableHeader.appendChild(th);
            });

            // 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            filteredData.forEach(row => {
                const tr = document.createElement('tr');
                columnsToDisplay.forEach(colName => {
                    const td = document.createElement('td');
                    td.innerText = row[colName] || "-"; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà -
                    tr.appendChild(td);
                });
                tableBody.appendChild(tr);
            });

            table.style.display = "table";
            loading.style.display = "none";
            emptyMsg.style.display = "none";
        } else {
            table.style.display = "none";
            loading.style.display = "none";
            emptyMsg.style.display = "block";
        }
    }

    fetchData();
</script>

</body>
</html>
