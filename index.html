<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 69/70</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2e7d32; --error: #d32f2f; --bg: #f5f7f9; }
        body { font-family: 'Sarabun', sans-serif; background-color: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 1400px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        h1 { color: var(--primary); text-align: center; margin-bottom: 25px; }
        
        /* ‡πÅ‡∏ñ‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
        #status { text-align: center; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-weight: bold; }
        .status-loading { background: #fff3cd; color: #856404; }
        .status-success { background: #d4edda; color: #155724; }
        .status-error { background: #f8d7da; color: #721c24; }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ */
        .tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; }
        .tab-btn { padding: 12px 24px; cursor: pointer; border: 2px solid var(--primary); background: white; color: var(--primary); font-weight: bold; border-radius: 30px; transition: 0.3s; }
        .tab-btn.active { background: var(--primary); color: white; }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
        .table-wrapper { overflow-x: auto; border: 1px solid #eee; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; min-width: 1200px; }
        th { background: var(--primary); color: white; padding: 14px 10px; font-size: 14px; position: sticky; top: 0; }
        td { padding: 12px 10px; border-bottom: 1px solid #f0f0f0; text-align: center; font-size: 14px; }
        tr:hover { background-color: #f9fff9; }
        .no-data { text-align: center; padding: 40px; color: #999; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏õ‡∏µ 69/70</h1>
    
    <div id="status" class="status-loading">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets (HTML)...</div>

    <div class="tabs">
        <button id="btn1" class="tab-btn active" onclick="updateView('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤')">‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ 69/70</button>
        <button id="btn2" class="tab-btn" onclick="updateView('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢')">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤ 69/70</button>
    </div>

    <div class="table-wrapper">
        <table id="mainTable">
            <thead>
                <tr>
                    <th>‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏áintech</th>
                    <th>‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà</th>
                    <th>‡πÄ‡∏Ç‡∏ï</th>
                    <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£</th>
                    <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</th>
                    <th>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                    <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                </tbody>
        </table>
        <div id="emptyMsg" class="no-data" style="display:none;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
    </div>
</div>

<script>
    // URL ‡∏ó‡∏µ‡πà‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡πÅ‡∏ö‡∏ö Web (pubhtml)
    const pubUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn/pubhtml?gid=1732816752";
    
    // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á
    const targetCols = ["‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏áintech", "‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà", "‡πÄ‡∏Ç‡∏ï", "‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å", "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£", "‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£"];
    
    let masterData = [];

    async function loadSheetHTML() {
        const statusEl = document.getElementById('status');
        try {
            // ‡πÉ‡∏ä‡πâ AllOrigins Proxy ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏° Domain
            const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(pubUrl)}&timestamp=${new Date().getTime()}`);
            if (!response.ok) throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Proxy ‡πÑ‡∏î‡πâ");
            
            const json = await response.json();
            const parser = new DOMParser();
            const doc = parser.parseFromString(json.contents, 'text/html');
            
            // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const allTables = Array.from(doc.querySelectorAll('table'));
            let targetRows = [];
            
            for (let table of allTables) {
                const rows = Array.from(table.querySelectorAll('tr'));
                // ‡∏´‡∏≤‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô Header
                if (rows.some(r => r.innerText.includes("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£"))) {
                    targetRows = rows;
                    break;
                }
            }

            if (targetRows.length === 0) throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'");

            // ‡∏´‡∏≤ Header ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const headerRowIdx = targetRows.findIndex(r => r.innerText.includes("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£"));
            const headers = Array.from(targetRows[headerRowIdx].querySelectorAll('td')).map(c => c.innerText.trim());

            masterData = targetRows.slice(headerRowIdx + 1).map(row => {
                const cells = Array.from(row.querySelectorAll('td')).map(c => c.innerText.trim());
                let obj = {};
                headers.forEach((h, i) => { if(h) obj[h] = cells[i] || ""; });
                return obj;
            });

            statusEl.className = "status-status status-success";
            statusEl.innerText = "‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
            updateView('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤');

        } catch (error) {
            statusEl.className = "status-status status-error";
            statusEl.innerText = "‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message;
            console.error(error);
        }
    }

    function updateView(filterValue) {
        document.getElementById('btn1').classList.toggle('active', filterValue === '‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤');
        document.getElementById('btn2').classList.toggle('active', filterValue === '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢');

        const tbody = document.getElementById('tableBody');
        const emptyMsg = document.getElementById('emptyMsg');
        const table = document.getElementById('mainTable');
        
        tbody.innerHTML = "";

        // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
        const filtered = masterData.filter(item => {
            const status = String(item['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] || "").trim();
            return status.includes(filterValue);
        });

        if (filtered.length === 0) {
            table.style.display = "none";
            emptyMsg.style.display = "block";
            return;
        }

        table.style.display = "table";
        emptyMsg.style.display = "none";

        filtered.forEach(row => {
            const tr = document.createElement('tr');
            targetCols.forEach(col => {
                const td = document.createElement('td');
                td.innerText = row[col] || "-";
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
        });
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    loadSheetHTML();
</script>

</body>
</html>
