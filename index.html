<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBS Sugar - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --kbs-green: #2E7D32; --kbs-orange: #FF9800; }
        body { font-family: 'Sarabun', sans-serif; background-color: #f8f9fa; }
        .kbs-header { background: linear-gradient(135deg, var(--kbs-green) 0%, #1565C0 100%); color: white; padding: 20px 0; border-bottom: 5px solid var(--kbs-orange); }
        .content-card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .nav-tabs .nav-link { border: none; font-weight: bold; color: #666; padding: 10px 20px; }
        .nav-tabs .nav-link.active { background: var(--kbs-green); color: white; border-radius: 10px; }
        #debugInfo { background: #fff3cd; padding: 10px; border-radius: 5px; font-size: 0.8rem; display: none; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="kbs-header mb-4">
    <div class="container d-flex align-items-center">
        <img src="https://i.postimg.cc/wMdZPmTL/skr-nch-xt-2026-01-12-092906.png" height="50" class="bg-white p-1 rounded me-3">
        <h1 class="h4 mb-0 fw-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏õ‡∏µ 69/70 (Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à)</h1>
    </div>
</div>

<div class="container">
    <div id="debugInfo" class="border"></div>

    <ul class="nav nav-tabs border-0 mb-3">
        <li class="nav-item"><button class="nav-link active" onclick="switchProject('‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70', this)">‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤</button></li>
        <li class="nav-item"><button class="nav-link" onclick="switchProject('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢ ‡∏õ‡∏µ 69/70', this)">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô</button></li>
    </ul>

    <div class="content-card">
        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="table-light text-success">
                    <tr>
                        <th>‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á</th>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà (‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤)</th>
                        <th>‡πÄ‡∏Ç‡∏ï</th>
                        <th>‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£</th>
                        <th class="text-end">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                        <th class="text-center">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr><td colspan="7" class="text-center p-5">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    const SHEET_ID = '2PACX-1vRY22UkMfLhAswqWJLCMvhCMeZxVsFQy1gLBLnrwB6VggruF4son8LZxN-EqtFxsUOdv1xs-Yf2cKnn';
    const GID = '1732816752'; 
    const URL = `https://docs.google.com/spreadsheets/d/e/${SHEET_ID}/pub?gid=${GID}&output=csv`;

    let fullData = [];
    let currentTab = '‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡πâ‡∏≠‡∏¢‡πÉ‡∏ô‡∏ô‡∏≤ ‡∏õ‡∏µ 69/70';

    async function fetchData() {
        const debug = document.getElementById('debugInfo');
        try {
            const response = await fetch(URL);
            if (!response.ok) throw new Error("‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å Google Sheets ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ");
            
            const text = await response.text();
            const rows = text.split('\n').filter(r => r.trim() !== "");
            
            // ‡πÅ‡∏õ‡∏•‡∏á CSV ‡πÄ‡∏õ‡πá‡∏ô JSON ‡πÅ‡∏ö‡∏ö Dynamic (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏Å‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì)
            const headers = rows[0].split(',').map(h => h.trim().replace(/"/g, ''));
            fullData = rows.slice(1).map(row => {
                const cols = row.split(',').map(c => c.trim().replace(/"/g, ''));
                let obj = {};
                headers.forEach((h, i) => obj[h] = cols[i]);
                return obj;
            });

            debug.innerHTML = "‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + fullData.length + " ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£";
            renderTable();
        } catch (err) {
            debug.style.display = "block";
            debug.innerHTML = "‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message + "<br>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ Publish ‡∏ä‡∏µ‡∏ó 'Data‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à' ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á";
        }
    }

    function renderTable() {
        const tbody = document.getElementById('tableBody');
        // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡πÄ‡∏õ‡πä‡∏∞‡∏Å‡∏±‡∏ö‡πÉ‡∏ô Google Sheet
        const filtered = fullData.filter(item => {
            const status = item['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] || '';
            return status === currentTab;
        });

        if (filtered.length === 0) {
            tbody.innerHTML = `<tr><td colspan="7" class="text-center p-5 text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ${currentTab}<br><small>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£" ‡∏ß‡πà‡∏≤‡∏™‡∏∞‡∏Å‡∏î‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</small></td></tr>`;
            return;
        }

        tbody.innerHTML = filtered.map(item => `
            <tr>
                <td class="fw-bold text-primary">${item['‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏áintech'] || '-'}</td>
                <td><b>${item['‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏ß‡πÑ‡∏£‡πà'] || '-'}</b><br><small class="text-muted">‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤: ${item['‡πÄ‡∏•‡∏Ç‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤'] || '-'}</small></td>
                <td>${item['‡πÄ‡∏Ç‡∏ï'] || '-'}</td>
                <td>${item['‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£'] || '-'}</td>
                <td class="text-end">${item['‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà'] || '0'}</td>
                <td><small>${item['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] || '-'}</small></td>
                <td class="text-center">
                    <span class="badge ${item['‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] === '‡∏ú‡πà‡∏≤‡∏ô' ? 'bg-success' : 'bg-warning text-dark'}">
                        ${item['‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£'] || '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à'}
                    </span>
                </td>
            </tr>
        `).join('');
    }

    function switchProject(name, btn) {
        currentTab = name;
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        btn.classList.add('active');
        renderTable();
    }

    fetchData();
</script>
</body>
</html>
